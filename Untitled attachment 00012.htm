<html><head><meta http-equiv="Content-Type" content="text/html charset=utf-8"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=""><div class=""></div><div class=""><div class="">
<div style="color: rgb(0, 0, 0); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=""><div style="orphans: auto; text-align: start; text-indent: 0px; widows: auto; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=""><div style="orphans: auto; text-align: start; text-indent: 0px; widows: auto; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=""><div style="orphans: auto; text-align: start; text-indent: 0px; widows: auto; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=""><div style="orphans: auto; text-align: start; text-indent: 0px; widows: auto; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=""><p style="orphans: 2; widows: 2; color: rgb(38, 38, 38); font-family: arial, helvetica; font-size: 9pt;" class="">--</p><p style="orphans: 2; widows: 2; color: rgb(38, 38, 38); font-family: arial, helvetica; font-size: 9pt;" class="">David Rivera Muñoz<br class=""><strong class="">Systems Engineer<br class="">AWS Certified Solutions Architect &amp; Sysops Administrator</strong></p><p style="orphans: 2; widows: 2; color: rgb(38, 38, 38); font-family: arial, helvetica; font-size: 9pt;" class=""><a href="mailto:david.rivera@claranet.es" style="color: rgb(38, 38, 38);" class="">david.rivera@claranet.es</a><br class="">Tel: 902 884 633 / +34 934 452 650</p><p style="orphans: 2; widows: 2; color: rgb(38, 38, 38); font-family: arial, helvetica; font-size: 9pt;" class="">Claranet S.A.U.<br class="">c/Juan Gris, 10-18, Torres Cerdà<br class="">08014 Barcelona<br class=""><a href="http://j.mp/hme_sign" style="color: rgb(38, 38, 38); font-size: 9pt;" class="">www.claranet.es</a></p><table border="0" cellpadding="0" cellspacing="0" style="font-family: Times; orphans: 2; widows: 2;" class=""><tbody class=""><tr class=""><td colspan="5" class="">&nbsp;</td></tr><tr class=""><td valign="bottom" class=""><a href="http://j.mp/hme_sign" title="“Web" oficial="" de="" claranet"="" class=""><img src="http://www.claranet.es/sites/all/assets/es/f-claranet.png" width="126" height="26" alt="Claranet" border="0" class=""></a></td><td class=""><br class=""><br class=""></td><td valign="bottom" class=""><a href="http://www.linkedin.com/company/claranet-s-a-u-" title="Linkedin" class=""><img src="http://www.claranet.es/sites/all/assets/es/f-linkedin.png" width="30" height="16" alt="Linkedin" border="0" class=""></a></td><td valign="bottom" class=""><a href="https://twitter.com/#!/Claranet_es" title="Twitter" class=""><img src="http://www.claranet.es/sites/all/assets/es/f-twitter.png" width="26" height="16" alt="Twitter" border="0" class=""></a></td><td valign="bottom" class=""><a href="http://www.youtube.com/user/claranetspain" title="YouTube" class=""><img src="http://www.claranet.es/sites/all/assets/es/f-youtube.png" width="26" height="16" alt="Youtube" border="0" class=""></a></td></tr></tbody></table><p style="orphans: 2; widows: 2; color: rgb(119, 119, 119); font-family: arial, helvetica; font-size: 9pt;" class=""><a href="http://www.claranet.es/lider-cuadrante-magico-de-gartner-cloud-hosting.html?utm_source=firmas_staff&amp;utm_medium=email&amp;utm_campaign=firma_email" class=""><img src="http://www.claranet.es/sites/all/assets/es/firma_gartner_2016.gif" title="Ver el Cuadrante Mágico completo" alt="Ver el Cuadrante Mágico completo" width="“467”" height="“55”" class=""></a></p><p style="orphans: 2; widows: 2; color: rgb(119, 119, 119); font-family: arial, helvetica; font-size: 9pt;" class="">Toda la información contenida en este mensaje electrónico de Claranet S.A.U. está protegida y cumple con<br class="">lo establecido en la LOPD 15/1999 según figura en el aviso legal:&nbsp;<a href="http://j.mp/leg_sign" title="Aviso Legal" style="color: rgb(119, 119, 119); font-size: 9pt;" class="">http://www.claranet.es/aviso-legal</a></p></div></div></div></div></div>
</div>
<br class=""><div><blockquote type="cite" class=""><div class="">On 10 Apr 2017, at 17:51, David Rivera Muñoz &lt;<a href="mailto:david.rivera@claranet.es" class="">david.rivera@claranet.es</a>&gt; wrote:</div><br class="Apple-interchange-newline"><div class=""><meta http-equiv="Content-Type" content="text/html charset=utf-8" class=""><div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=""><div class="">Hola Aureli,</div><div class=""><br class=""></div><div class="">te clasifico las acciones que recomendamos realizar según complejidad.</div><div class=""><br class=""></div><div class=""><u class=""><b class="">Wins a corto plazo</b></u></div><div class=""><br class=""></div><div class=""><ul class=""><li class="">Finalizar accesos vía Security Groups.&nbsp;</li><ul class=""><li class="">Securizar EFS: Faltaba securizar el acceso al EFS. Idealmente crearíamos un nuevo SG (p.ej. prd_efs_sg) y crear una ingress rule en este para el puerto de EFS (2049) abierto para los miembros del SG que toque (la capa de SFTP, por ejemplo).&nbsp;</li><li class="">Eliminar security Groups con acceso global: Una vez comprobado el funcionamiento correcto de estas interconexiones entre capas (vía telnet o netcat). Deberíamos eliminar el acceso global desde la VPC de producción.</li></ul><li class="">Mejoras puntuales en los scripts de Terraform.</li><ul class=""><li class="">Poner en práctica estándares de nomenclatura en ficheros de terraform: Todas las variables en CamelCase/Mayúscula/Minúscula, namespace de los recursos (proponemos environment_rol_tipoderecurso).</li><li class="">Eliminar referencias estáticas a id de recurso, cambiándolas por variables/inputs siempre que sea necesario.</li></ul><li class="">Replicar cambios para todos los proyectos en todos los entornos.</li><li class="">Modificar IOPS en RDS.</li><ul class=""><li class="">Recordar que el númeor de IOPS en gp2 es de 3 veces el tamaño en GiB del disco. Sacamos el máximo partido de un disco SSD provisionando 1TiB (3000 IOPS + Bursts ocasionales)</li></ul><li class="">Modificar discos en todas las instancias de gp2 a Magnético.</li><ul class=""><li class="">Por el mismo motivo, con discos de 10GiB tenemos unas 30 IOPS en SSD. Con Magnético tenemos unas IOPS siempre del orden del centenar.</li></ul><li class="">Modificar instancias de c3.large a c4.large.</li><ul class=""><li class="">Más modernas, con más ECU y pricing algo inferior (~5% menos).</li></ul></ul></div><div class=""><br class=""></div><div class=""><u class=""><b class="">Wins a medio plazo</b></u></div><div class=""><br class=""></div><div class=""><ul class=""><li class="">Hacer modulares los scripts de Terraform.</li><ul class=""><li class="">Comentamos el hacer los recursos independientes del entorno, inyectándolo como variable. Pero creemos que la complejidad añadida con condicionales es demasiado grande y hace ilegible el .tf file, lo más práctico es hacer un scripting modular.</li><li class="">Adjunto un módulo de creación de VPC a modo de ejemplo.</li></ul><li class="">Resolver problema de deploys lentos en la capa de frontends Web.</li><ul class=""><li class="">Este es uno de los temas que nos quedó pendiente de investigar, todo apunta a que la problemática viene provocada por el método de deploy. Es algo que deberíamos revisar.</li></ul><li class="">Crear un test de carga realista o pesimista.</li><ul class=""><li class="">Probar a saturar el sistema para identificar cuellos de botella.</li></ul><li class="">Ajustar IOPS y tamaño de instancias según comportamiento del entorno con carga.</li><ul class=""><li class="">Según el funcionamiento de la plataforma durante los tests de carga, es bastante probable que podamos ajustar más famílias de ciertas capas.</li></ul></ul></div><div class=""><br class=""></div><div class=""><br class=""></div><div class=""><b class=""><u class="">Wins a largo plazo</u></b></div><div class=""><br class=""></div><div class=""><ul class="MailOutline"><li class="">Evaluar la conveniencia de uso del servicio de OpsWorks.</li><ul class=""><li class="">Vimos la problemática con los Security Groups cambiados desde Terraform que no se propagan a las Instancias hasta forzar el STOP/START desde OpsWorks.</li><li class="">Seguramente surgiran nuevas problemáticas similares debido a esta gestión de infrastructura dual (Terraform/Opsworks). Es posible que el problema de los deploys lentos en la Capa de Web sean debidos a esto.</li><li class="">En caso de no aprovecharse del todo el servicio de OpsWorks, podriamos beneficiarnos de usar grupos de autoescalado estándards (más flexibles y económicos, aunque menos mantenibles).</li></ul><li class="">Introducir otros servicios propios de AWS</li><ul class=""><li class="">Cómo ya comentamos, cabría la posibilidad de migrar algunas de las funcionalidades a servicios concretos de AWS.</li><li class="">Una de las soluciones para evitar la dependencia con AWS es desarrollar una capa de abstracción para usar los servicios, de manera que se simplifique modificar la infrastructura subyacente.</li></ul></ul><div class=""><br class=""></div></div><div class=""><br class=""></div><div class=""><br class=""></div><div class=""><br class=""></div><div class="">Si os quedase alguna duda de cualquiera de estos puntos, comentádnoslo sin problema alguno.&nbsp;</div><div class=""><br class=""></div><div class="">De todos modos, me comentaba Miquel que intentaría agendar con vosotros una call para hacer review sobre estos puntos y sobre la experiencia en general.</div><div class=""><br class=""></div><div class=""><br class=""></div><div class=""><br class=""></div><div class="">Saludos,</div><div class=""><br class=""></div><div class="">
<div style="letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=""><div style="orphans: auto; text-align: start; text-indent: 0px; widows: auto; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=""><div style="orphans: auto; text-align: start; text-indent: 0px; widows: auto; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=""><div style="orphans: auto; text-align: start; text-indent: 0px; widows: auto; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=""><div style="orphans: auto; text-align: start; text-indent: 0px; widows: auto; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=""><p style="orphans: 2; widows: 2; color: rgb(38, 38, 38); font-family: arial, helvetica; font-size: 9pt;" class="">--</p><p style="orphans: 2; widows: 2; color: rgb(38, 38, 38); font-family: arial, helvetica; font-size: 9pt;" class="">David Rivera Muñoz<br class=""><strong class="">Systems Engineer<br class="">AWS Certified Solutions Architect &amp; Sysops Administrator</strong></p><p style="orphans: 2; widows: 2; color: rgb(38, 38, 38); font-family: arial, helvetica; font-size: 9pt;" class=""><a href="mailto:david.rivera@claranet.es" style="color: rgb(38, 38, 38);" class="">david.rivera@claranet.es</a><br class="">Tel: 902 884 633 / +34 934 452 650</p><p style="orphans: 2; widows: 2; color: rgb(38, 38, 38); font-family: arial, helvetica; font-size: 9pt;" class="">Claranet S.A.U.<br class="">c/Juan Gris, 10-18, Torres Cerdà<br class="">08014 Barcelona<br class=""><a href="http://j.mp/hme_sign" style="color: rgb(38, 38, 38); font-size: 9pt;" class="">www.claranet.es</a></p><table border="0" cellpadding="0" cellspacing="0" style="font-family: Times; orphans: 2; widows: 2;" class=""><tbody class=""><tr class=""><td colspan="5" class="">&nbsp;</td></tr><tr class=""><td valign="bottom" class=""><a href="http://j.mp/hme_sign" title="“Web" oficial="" de="" claranet"="" class=""><img src="http://www.claranet.es/sites/all/assets/es/f-claranet.png" width="126" height="26" alt="Claranet" border="0" class=""></a></td><td class=""><br class=""><br class=""></td><td valign="bottom" class=""><a href="http://www.linkedin.com/company/claranet-s-a-u-" title="Linkedin" class=""><img src="http://www.claranet.es/sites/all/assets/es/f-linkedin.png" width="30" height="16" alt="Linkedin" border="0" class=""></a></td><td valign="bottom" class=""><a href="https://twitter.com/#!/Claranet_es" title="Twitter" class=""><img src="http://www.claranet.es/sites/all/assets/es/f-twitter.png" width="26" height="16" alt="Twitter" border="0" class=""></a></td><td valign="bottom" class=""><a href="http://www.youtube.com/user/claranetspain" title="YouTube" class=""><img src="http://www.claranet.es/sites/all/assets/es/f-youtube.png" width="26" height="16" alt="Youtube" border="0" class=""></a></td></tr></tbody></table><p style="orphans: 2; widows: 2; color: rgb(119, 119, 119); font-family: arial, helvetica; font-size: 9pt;" class=""><a href="http://www.claranet.es/lider-cuadrante-magico-de-gartner-cloud-hosting.html?utm_source=firmas_staff&amp;utm_medium=email&amp;utm_campaign=firma_email" class=""><img src="http://www.claranet.es/sites/all/assets/es/firma_gartner_2016.gif" title="Ver el Cuadrante Mágico completo" alt="Ver el Cuadrante Mágico completo" width="“467”" height="“55”" class=""></a></p><p style="orphans: 2; widows: 2; color: rgb(119, 119, 119); font-family: arial, helvetica; font-size: 9pt;" class="">Toda la información contenida en este mensaje electrónico de Claranet S.A.U. está protegida y cumple con<br class="">lo establecido en la LOPD 15/1999 según figura en el aviso legal:&nbsp;<a href="http://j.mp/leg_sign" title="Aviso Legal" style="color: rgb(119, 119, 119); font-size: 9pt;" class="">http://www.claranet.es/aviso-legal</a></p></div></div></div></div></div>
</div>
<br class=""></div></div></blockquote></div><br class=""></div></body></html>